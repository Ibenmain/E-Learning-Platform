from __future__ import annotations

from typing import List
from typing import Optional

from google.oauth2.webauthn_handler import PluginHandler
from google.oauth2.webauthn_handler import WebAuthnHandler


class WebauthnHandlerFactory:
    handlers: list[WebAuthnHandler]

    def __init__(self):
        self.handlers = [PluginHandler()]

    def get_handler(self) -> WebAuthnHandler | None:
        for handler in self.handlers:
            if handler.is_available():
                return handler
        return None
